<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>UNO Game</title>
    <style>
      .game-area {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 20px;
      }

      .play-area {
          display: flex;
          gap: 20px;
          align-items: center;
          margin: 20px 0;
      }

      .deck {
          margin-left: 50px;
      }

      .computer-hand {
          position: relative;
          display: flex;
          gap: 10px;
          margin: 20px 0;
          padding-bottom: 25px;
      }

      .computer-hand::after {
          content: attr(data-count);
          position: absolute;
          bottom: 0;
          left: 50%;
          transform: translateX(-50%);
          font-size: 18px;
          color: #000;
          font-weight: bold;
      }

      .card-back, .deck {
          width: 100px;
          height: 150px;
          border: 2px solid black;
          border-radius: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
          cursor: pointer;
          color: #a2260b;
          background-color: #ffdf00;
          background-image: url('data:image/svg+xml,\
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 1250" preserveAspectRatio="xMidYMid meet">\
              <g transform="scale(1.2) translate(-140,104)">\
                <rect width="2000" height="1250" fill="%23ffdf00"/>\
                <path d="m1289.9 235.83 56.57-56.57v56.57h56.57l-56.57 56.57 56.57 56.57h-56.57v56.56l-56.57-56.57-56.56 56.57v-56.57h-56.57l56.57-56.56-56.57-56.57h56.56v-56.57zm-36.57 20v-28.29l36.57 36.57 36.57-36.56v28.28h28.29l-36.57 36.57 36.56 36.56h-28.28v28.29l-36.57-36.57-36.57 36.57v-28.29h-28.28l36.57-36.56-36.57-36.57z" fill="%23a2260b"/>\
                <path d="m710.06 235.83 56.57-56.57v56.57h56.57l-56.57 56.57 56.57 56.57-56.57-0.01 0.01 56.57-56.57-56.57-56.57 56.57v-56.57h-56.57l56.57-56.57-56.57-56.57h56.57v-56.56zm-36.57 19.99v-28.28l36.57 36.57 36.57-36.57v28.28h28.29l-36.57 36.57 36.56 36.57h-28.28v28.28l-36.56-36.56-36.58 36.57v-28.29h-28.27l36.56-36.57-36.57-36.57z" fill="%23a2260b"/>\
                <path d="m1e3 115.5 56.56-56.57 0.01 56.57h56.56l-56.56 56.57 56.57 56.57-56.57-0.01v56.57l-56.57-56.57-56.57 56.57v-56.57h-56.56l56.56-56.57-56.57-56.57 56.57 0.01v-56.57zm-36.57 19.99v-28.28l36.57 36.57 36.56-36.57v28.28h28.29l-36.57 36.57 36.57 36.57h-28.29v28.28l-36.56-36.56-36.57 36.57v-28.29h-28.28l36.56-36.57-36.57-36.57z" fill="%23a2260b"/>\
                <polygon points="1.035e3 9.7e2 2.0e3 9.7e2 2.0e3 9.4e2 1.065e3 9.4e2 1.065e3 644.61000 1.1414e3 568.19000 1.1909e3 617.69000 1.1626e3 645.97000 1.1485e3 631.83000 1.1626e3 617.69000 1.1414e3 596.48000 1.1061e3 631.83000 1.1697e3 695.47000 1.2121e3 653.05000 1.2121e3 596.48000 1.1414e3 525.77000 1.035e3 632.19000" fill="%23a2260b"/>\
                <polygon points="9.65e2 9.7e2 0 9.7e2 0 9.4e2 9.35e2 9.4e2 9.35e2 644.61000 858.58000 568.19000 809.08000 617.69000 837.37000 645.97000 851.51000 631.83000 837.37000 617.69000 858.58000 596.48000 893.93000 631.83000 830.29000 695.47000 787.87000 653.05000 787.87000 596.47000 858.58000 525.76000 9.65e2 632.19000" fill="%23a2260b"/>\
                <polygon points="9.65e2 6.039e2 787.87000 426.77000 724.23000 490.41000 773.73000 539.91000 802.01000 511.62000 787.87000 497.48000 773.73000 511.62000 752.52000 490.41000 787.87000 455.05000 844.44000 511.62000 794.94000 561.12000 738.38000 561.12000 667.66000 490.41000 752.52000 405.56000 809.09000 405.56000 9.65e2 561.47000" fill="%23a2260b"/>\
                <polygon points="1.035e3 6.039e2 1.2121e3 426.77000 1.2758e3 490.41000 1.2263e3 539.91000 1.198e3 511.62000 1.2121e3 497.48000 1.2263e3 511.62000 1.2475e3 490.41000 1.2121e3 455.05000 1.1556e3 511.62000 1.2051e3 561.12000 1.2616e3 561.12000 1.3323e3 490.41000 1.2475e3 405.56000 1.1909e3 405.56000 1.035e3 561.47000" fill="%23a2260b"/>\
                <polygon points="9.85e2 1.0e3 9.85e2 553.19000 823.23000 391.42000 823.23000 334.85000 908.08000 2.5e2 978.79000 320.71000 978.79000 377.27000 929.29000 426.77000 872.72000 3.702e2 908.08000 334.85000 929.29000 356.06000 915.15000 3.702e2 929.29000 384.34000 957.57000 356.06000 908.08000 306.56000 844.44000 3.702e2 1.0e3 525.76000 1.1556e3 3.702e2 1.0919e3 306.56000 1.0424e3 356.06000 1.0707e3 384.34000 1.0848e3 3.702e2 1.0707e3 356.06000 1.0919e3 334.85000 1.1273e3 3.702e2 1.0707e3 426.77000 1.0212e3 377.27000 1.0212e3 320.71000 1.0919e3 2.5e2 1.1768e3 334.85000 1.1768e3 391.42000 1.015e3 553.19000 1.015e3 1.0e3 2.0e3 1.0e3 2.0e3 1.25e3 0 1.25e3 0 1.0e3" fill="%23a2260b"/>\
              </g>\
            </svg>');
          background-size: contain;
          background-repeat: space;
          background-position: center bottom;
      }

      .card-back {
          transform: rotate(180deg);
      }

      .card {
          width: 100px;
          height: 150px;
          border: 2px solid black;
          border-radius: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
          cursor: pointer;
          margin: 5px;
          box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
      }

      .player-hand {
          display: flex;
          gap: 10px;
          margin: 20px 0;
      }

      .red { background-color: #ff5555; }
      .blue { background-color: #5555ff; }
      .green { background-color: #55ff55; }
      .yellow { background-color: #ffff55; }
    </style>
  </head>
  <body>
    <div class="game-area">
      <div class="computer-hand" id="computerHand"></div>
      <div class="play-area">
        <div class="deck" id="deck" onclick="drawCard()"></div>
        <div class="card" id="currentCard"></div>
      </div>
      <div class="player-hand" id="playerHand"></div>
    </div>

    <script>
      let deck = [];
      let playerHand = [];
      let computerHand = [];
      let currentCard;
      let isPlayerTurn = true;

      const colors = ['red', 'blue', 'green', 'yellow'];
      const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];

      function createDeck() {
          colors.forEach(color => {
              numbers.forEach(number => {
                  deck.push({ color, number });
              });
          });

          // Перемешиваем колоду
          for (let i = deck.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [deck[i], deck[j]] = [deck[j], deck[i]];
          }
      }

      function dealInitialCards() {
          // Раздаем по 7 карт каждому игроку
          for (let i = 0; i < 7; i++) {
              playerHand.push(deck.pop());
              computerHand.push(deck.pop());
          }

          // Открываем первую карту
          currentCard = deck.pop();
      }

      function createCardElement(card, isComputerCard = false) {
          const cardElement = document.createElement('div');

          if (isComputerCard) {
              cardElement.className = 'card-back';
          } else {
              cardElement.className = `card ${card.color}`;
              cardElement.textContent = card.number;
              if (!isComputerCard) {
                  cardElement.onclick = () => playCard(card);
              }
          }
          return cardElement;
      }

      function updateGameDisplay() {
          const computerHandElement = document.getElementById('computerHand');
          const playerHandElement = document.getElementById('playerHand');
          const currentCardElement = document.getElementById('currentCard');
          const deckElement = document.getElementById('deck');

          computerHandElement.innerHTML = '';
          playerHandElement.innerHTML = '';

          computerHand.forEach(() => {
              computerHandElement.appendChild(createCardElement(null, true));
          });

          playerHand.forEach(card => {
              playerHandElement.appendChild(createCardElement(card));
          });

          currentCardElement.className = `card ${currentCard.color}`;
          currentCardElement.textContent = currentCard.number;

          deckElement.textContent = deck.length;

          // Обновляем счетчик карт в колоде
          deckElement.setAttribute('data-count', deck.length);
      }

      function playCard(card) {
          if (!isPlayerTurn) return;
          if (!canPlayCard(card)) return;

          const cardIndex = playerHand.findIndex(c => c.color === card.color && c.number === card.number);
          currentCard = playerHand.splice(cardIndex, 1)[0];

          if (playerHand.length === 0) {
              alert('Вы победили!');
              startNewGame();
              return;
          }

          isPlayerTurn = false;
          updateGameDisplay();
          setTimeout(computerTurn, 1000);
      }

      function canPlayCard(card) {
          return card.color === currentCard.color ||
                 card.number === currentCard.number;
      }

      function drawCard() {
          if (!isPlayerTurn) return;

          if (deck.length === 0) {
              alert('Колода пуст!');
              return;
          }

          playerHand.push(deck.pop());
          isPlayerTurn = false;
          updateGameDisplay();
          setTimeout(computerTurn, 1000);
      }

      function computerTurn() {
          let playedCard = false;

          for (let i = 0; i < computerHand.length; i++) {
              if (canPlayCard(computerHand[i])) {
                  currentCard = computerHand.splice(i, 1)[0];
                  playedCard = true;
                  break;
              }
          }

          if (!playedCard && deck.length > 0) {
              computerHand.push(deck.pop());
          }

          if (computerHand.length === 0) {
              alert('Компьютер победил!');
              startNewGame();
              return;
          }

          isPlayerTurn = true;
          updateGameDisplay();
      }

      function startNewGame() {
          deck = [];
          playerHand = [];
          computerHand = [];
          createDeck();
          dealInitialCards();
          isPlayerTurn = true;
          updateGameDisplay();
      }

      startNewGame();
    </script>
  </body>
</html>
